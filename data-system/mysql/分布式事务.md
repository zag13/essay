# 分布式事务

[思维导图](/mind.html?path=/data-system/mysql/分布式事务)

分布式事务涉及多个节点，是一个典型的分布式系统，与单机系统有非常大的差别。
一个分布式系统最多只能同时满足一致性、可用性和分区容错性这三项中的两项，这被称为CAP理论。（一般保证P和A，舍弃C）

- **一致性（Consistency）** 分布式系统中的所有数据备份，在同一时刻是否同样的值。

  在分布式系统中，如果能够做到针对一个数据项的更新操作执行成功后，所有的用户都能读取到最新的值，那么这样的系统就被认为具有强一致性（或严格的一致性）。

- **可用性（Availability）** 在集群中一部分节点故障后，集群整体是否还能响应客户端的读写请求。

- **分区容错性（Partition tolerance）** 分布式系统中的节点（进程或者计算机）分布在不同的机架上，每个机架都有一个独立的网络分区，当某个网络分区发生故障后，系统整体是否还能继续工作。

**BASE理论**

BASE是Basically Available（基本可用）、Soft state（软状态）和Eventually consistent（最终一致性）三个短语的简写。
BASE理论是对CAP中一致性和可用性权衡的结果，其来源于对大规模互联网分布式实践的总结，是基于CAP定理逐步演化而来的。
其核心思想是即使无法做到强一致性，但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性。

## SAGA

SAGA核心思想是将长事务拆分为多个短事务，由Saga事务协调器协调。
如果每个短事务都成功提交完成，那么全局事务就正常完成，如果某个步骤失败，则根据相反顺序一次调用补偿操作。

- 优点
- 缺点

## 推荐阅读

- [分布式事务理论](https://dtm.pub/practice/theory.html)